<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì˜¤ë¥˜ê³ ë“±í•™êµ 1í•™ë…„ ìˆ˜ê°•ì‹ ì²­ ì‹œë®¬ë ˆì´í„°</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f7f9fb;
    padding: 20px;
  }
  h1 {
    text-align: center;
    margin-bottom: 30px;
  }
  .semester-container {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: center;
  }
  .semester {
    width: 400px;
    border: 2px solid #ccc;
    border-radius: 10px;
    background: #fff;
    padding: 15px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
  }
  .semester h2 {
    text-align: center;
    font-size: 18px;
    margin-bottom: 10px;
  }
  .course-area {
    margin-bottom: 12px;
  }
  .area-title {
    font-weight: bold;
    margin: 10px 0 6px;
  }
  .course-list {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
  }
  .course-item {
    border-radius: 8px;
    padding: 6px 10px;
    cursor: pointer;
    background-color: #eee;
    font-size: 13px;
  }
  .course-item.fixed {
    cursor: not-allowed;
  }
  .basket {
    border: 2px dashed #aaa;
    border-radius: 8px;
    padding: 10px;
    min-height: 60px;
    margin-top: 10px;
  }
  .basket-title {
    font-size: 14px;
    font-weight: bold;
    margin-bottom: 5px;
  }
  .highlight-valid {
  animation: blinkGreenEnhanced 0.7s infinite alternate;
  border-width: 3px;
  box-shadow: 0 0 10px rgba(76, 175, 80, 0.6); /* ì—°ë‘ìƒ‰ ê·¸ë¦¼ì */
}

@keyframes blinkGreenEnhanced {
  0% {
    border-color: #4CAF50;
    background-color: #e8f5e9; /* ì—°ë‘ ë°°ê²½ */
  }
  100% {
    border-color: #81C784;
    background-color: #f1f8e9; /* ë” ì˜…ì€ ì—°ë‘ */
  }
}

  .course-korean { background-color: #fff9c4; }
  .course-math { background-color: #bbdefb; }
  .course-english { background-color: #ffcdd2; }
  .course-science { background-color: #c8e6c9; }
  .course-society { background-color: #ffe0b2; }
  .course-physical { background-color: #CCD5FF; }
  .course-language { background-color: #e1bee7; }
  .course-art { background-color: #f8bbd0; }
  .course-info { background-color: #b2dfdb; }
  .course-liberal { background-color: #e4dcd9; }
  .message {
    color: red;
    font-size: 14px;
    margin-top: 10px;
  }
.legend {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
  margin: 20px 0;
}

.legend-item {
  font-size: 13px;
  padding: 4px 10px;
  border-radius: 8px;
  background-color: #eee;
  color: #333;
  white-space: nowrap;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}
#studentInfo {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin-bottom: 20px;
  }
 .footer {
    position: fixed;
    bottom: 10px;
    right: 10px;
    font-size: 20px;
    color: #888;
  }
.notice-box {
  max-width: 860px;
  margin: 0 auto 20px;
  background-color: #fffde7;
  border: 2px solid #fbc02d;
  border-radius: 10px;
  padding: 15px 20px;
  font-size: 14px;
  color: #444;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
}
.notice-box h3 {
  margin: 0 0 8px;
  font-size: 16px;
  color: #e65100;
}
.notice-box ul {
  padding-left: 20px;
  margin: 0;
}
.notice-box li {
  margin-bottom: 6px;
  line-height: 1.5;
}
.total-summary-box {
  max-width: 800px;
  margin: 40px auto 0;
  background-color: #e8f5e9;
  border: 2px solid #4CAF50;
  border-radius: 10px;
  padding: 16px 20px;
  font-size: 15px;
  color: #2e7d32;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
}
.total-summary-box h3 {
  margin-top: 0;
  margin-bottom: 8px;
  font-size: 16px;
  color: #1b5e20;
}
.total-summary-box p {
  margin: 4px 0;
  font-weight: bold;
}
.red-outline {
  outline: 2px solid red !important;
  outline-offset: -2px;
}
</style>

</head>

<body>
  <h1>ì˜¤ë¥˜ê³ ë“±í•™êµ 1í•™ë…„ ìˆ˜ê°•ì‹ ì²­ ì‹œë®¬ë ˆì´í„°</h1>
<div id="studentInfo">
    <label>í•™ë²ˆ: <input type="text" id="studentId" style="margin-right:20px;"></label>
    <label>ì´ë¦„: <input type="text" id="studentName"></label>
    <label>í¬ë§í•™ê³¼(ê³„ì—´): <input type="text" id="studentMajor"></label>
  </div>

<div class="notice-box">
  <h3>ğŸ“Œ ì‹ ì²­ ì‹œ ìœ ì˜ì‚¬í•­</h3>
  <ul>
    <li>1. êµ­ì–´, ìˆ˜í•™, ì˜ì–´ ì˜ì—­ì˜ ê³¼ëª© ì‹ ì²­ ì´í•©ì€ <strong>57í•™ì </strong>ì„ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</li>
    <li>2. ì œ2ì™¸êµ­ì–´, ì •ë³´, êµì–‘ ì˜ì—­ì˜ ê³¼ëª© ì‹ ì²­ ì´í•©ì€ <strong>12í•™ì  ì´ìƒ</strong> ì‹ ì²­í•´ì•¼ í•©ë‹ˆë‹¤.</li>
  </ul>
</div>
<div class="legend">
  <div class="legend-item" style="background-color:#fff9c4;">êµ­ì–´</div>
  <div class="legend-item" style="background-color:#bbdefb;">ìˆ˜í•™</div>
  <div class="legend-item" style="background-color:#ffcdd2;">ì˜ì–´</div>
  <div class="legend-item" style="background-color:#ffe0b2;">ì‚¬íšŒ</div>
  <div class="legend-item" style="background-color:#c8e6c9;">ê³¼í•™</div>
  <div class="legend-item" style="background-color:#CCD5FF;">ì²´ìœ¡</div>
  <div class="legend-item" style="background-color:#f8bbd0;">ì˜ˆìˆ </div>
  <div class="legend-item" style="background-color:#b2dfdb;">ì •ë³´</div>
  <div class="legend-item" style="background-color:#e1bee7;">ì œ2ì™¸êµ­ì–´</div>
  <div class="legend-item" style="background-color:#e4dcd9;">êµì–‘</div>
</div>
  <div class="footer">made by ê¹€ë¯¼ë²”&ì´í˜„ìš°ì„ ìƒë‹˜</div>

<div class="semester-container">
  <div class="semester" id="semester-2-1">
<h2>2í•™ë…„ 1í•™ê¸°</h2>
      <!-- 1í–‰: ì„ íƒ ê°€ëŠ¥ ê³¼ëª© ë¦¬ìŠ¤íŠ¸ -->
      <div class="course-area">
        <div class="area-title">í•„ìˆ˜ ê³¼ëª©</div>
        <div class="course-list">
          <div class="course-item fixed course-korean">ë¬¸í•™_ì¼(4)</div>
          <div class="course-item fixed course-math">ëŒ€ìˆ˜_ì¼(4)</div>
          <div class="course-item fixed course-english">ì˜ì–´1_ì¼(4)</div>
          <div class="course-item fixed course-physical">ìŠ¤í¬ì¸ ìƒí™œ1_ìœµ(2)</div>
        </div>
      </div>
      <div class="course-area">
        <div class="area-title">ì„ íƒê³¼ëª©1 (3ê°œ ì„ íƒ)</div>
        <div class="course-list">
          <div class="course-item course-korean">ë…ì„œí† ë¡ ê¸€ì“°ê¸°_ìœµ(4)</div>
          <div class="course-item course-math">ê¸°í•˜_ì§„(4)</div>
          <div class="course-item course-english">ë¯¸ë””ì–´ì˜ì–´_ìœµ(4)</div>
          <div class="course-item course-society">ì‚¬íšŒì™€ ë¬¸í™”_ì¼(4)</div>
          <div class="course-item course-society">ê²½ì œ_ì§„(4)</div>
          <div class="course-item course-society">ì„¸ê³„ì‹œë¯¼ê³¼ ì§€ë¦¬_ì¼(4)</div>
          <div class="course-item course-society">ì—­ì‚¬ë¡œ íƒêµ¬í•˜ëŠ” í˜„ëŒ€ì„¸ê³„_ìœµ(4)</div>
          <div class="course-item course-science">ìƒëª…ê³¼í•™_ì¼(4)</div>
          <div class="course-item course-science">ë¬¼ë¦¬í•™_ì¼(4)</div>
          <div class="course-item course-physical">ìš´ë™ê³¼ê±´ê°•_ì§„(4)</div>
          <div class="course-item course-language">ì¤‘êµ­ì–´1_ì¼(4)</div>
          <div class="course-item course-language">ì¼ë³¸ì–´1_ì¼(4)</div>
          <div class="course-item course-language">ìŠ¤í˜ì¸ì–´1_ì¼(4)</div>
        </div>
      </div>
      <div class="course-area">
        <div class="area-title">ì„ íƒê³¼ëª©2 (1ê°œ ì„ íƒ)</div>
        <div class="course-list">
          <div class="course-item course-art">ìŒì•…ì—°ì£¼ì™€ ì°½ì‘_ì§„(2)</div>
          <div class="course-item course-art">ë¯¸ìˆ  ì°½ì‘_ì§„(2)</div>
        </div>
      </div>
      <div class="course-area">
        <div class="area-title">ì„ íƒê³¼ëª©3 (1ê°œ ì„ íƒ)</div>
        <div class="course-list">
          <div class="course-item course-liberal">ì¸ê°„ê³¼ ì‹¬ë¦¬_ì§„(2)</div>
          <div class="course-item course-liberal">ë³´ê±´_ì§„(2)</div>
                  </div>
      </div>
      <!-- 2í–‰: ë‚´ ì„ íƒê³¼ëª© ë°”êµ¬ë‹ˆ -->
      <div class="basket" id="basket-2-1">
        <div class="basket-title">ë‚´ ì„ íƒê³¼ëª©</div>
        <!-- ì„ íƒëœ ê³¼ëª©ì´ ì—¬ê¸°ì— í‘œì‹œë  ì˜ˆì • -->
      </div>
    </div>
  <div class="semester" id="semester-2-2">
      <h2>2í•™ë…„ 2í•™ê¸°</h2>
      <div class="course-area">
        <div class="area-title">í•„ìˆ˜ ê³¼ëª©</div>
        <div class="course-list">
          <div class="course-item fixed course-korean">í™”ë²•ê³¼ ì–¸ì–´_ì¼(4)</div>
          <div class="course-item fixed course-math">ë¯¸ì ë¶„1_ì¼(4)</div>
          <div class="course-item fixed course-english">ì˜ì–´2_ì¼(4)</div>
          <div class="course-item fixed course-physical">ìŠ¤í¬ì¸ ìƒí™œ2_ìœµ(2)</div>
        </div>
      </div>
      <div class="course-area">
        <div class="area-title">ì„ íƒ ê³¼ëª© (4í•™ì  4ê°œ ë˜ëŠ” 4í•™ì  3ê°œ + 2í•™ì  2ê°œ)</div>
        <div class="course-list">
          <div class="course-item course-korean">ì£¼ì œ íƒêµ¬ ë…ì„œ_ì§„(4)</div>
          <div class="course-item course-math">ì¸ê³µì§€ëŠ¥ìˆ˜í•™_ì§„(4)</div>
          <div class="course-item course-math">ê²½ì œ ìˆ˜í•™_ì§„(4)</div>
          <div class="course-item course-english">ì„¸ê³„ë¬¸í™”ì™€ ì˜ì–´_ìœµ(4)</div>
          <div class="course-item course-society">ë²•ê³¼ ì‚¬íšŒ_ì§„(4)</div>
          <div class="course-item course-society">ì—¬í–‰ì§€ë¦¬_ìœµ(4)</div>
          <div class="course-item course-society">ë™ì•„ì‹œì•„ì—­ì‚¬ê¸°í–‰_ì§„(4)</div>
          <div class="course-item course-society">í˜„ëŒ€ì‚¬íšŒì™€ ìœ¤ë¦¬_ì¼(4)</div>
          <div class="course-item course-society">ì„¸ê³„ë¬¸ì œì™€ ë¯¸ë˜ì‚¬íšŒ_ìœµ(4)</div>
          <div class="course-item course-science">í™”í•™_ì¼(4)</div>
          <div class="course-item course-science">ì§€êµ¬ê³¼í•™_ì¼(4)</div>
          <div class="course-item course-science">ì „ìê¸°ì™€ ì–‘ì_ì§„(4)</div>
          <div class="course-item course-science">ìƒë¬¼ì˜ ìœ ì „_ì§„(4)</div>
          <div class="course-item course-info">ë°ì´í„° ê³¼í•™_ì •(4)</div>
          <div class="course-item course-language">ì¤‘êµ­ì–´1_ì¼(4)</div>
          <div class="course-item course-language">ì¼ë³¸ì–´1_ì¼(4)</div>
          <div class="course-item course-language">ìŠ¤í˜ì¸ì–´1_ì¼(4)</div>
          <div class="course-item course-liberal">ì¸ê°„ê³¼ ì‹¬ë¦¬_ì§„(2)</div>
          <div class="course-item course-liberal">ë…¼ë¦¬ì™€ ì‚¬ê³ _ì§„(2)</div>
          <div class="course-item course-liberal">ë³´ê±´_ì§„(2)</div>
          <div class="course-item course-liberal">í†µê³„ì™€ ì‚¬íšŒ_ìœµ(2)</div>
        </div>
      </div>
      <div class="basket" id="basket-2-2">
        <div class="basket-title">ë‚´ ì„ íƒê³¼ëª©</div>
      </div>
    </div>
  <div class="semester" id="semester-3-1">
      <h2>3í•™ë…„ 1í•™ê¸°</h2>
      <div class="course-area">
        <div class="area-title">í•„ìˆ˜ ê³¼ëª©</div>
        <div class="course-list">
          <div class="course-item fixed course-korean">ë…ì„œì™€ ì‘ë¬¸_ì¼(4)</div>
          <div class="course-item fixed course-math">í™•ë¥ ê³¼ í†µê³„_ì¼(4)</div>
          <div class="course-item fixed course-physical">ìŠ¤í¬ì¸ ê³¼í•™_ì§„(2)</div>
        </div>
      </div>
      <div class="course-area">
        <div class="area-title">ì„ íƒê³¼ëª©1 (4ê°œ ì„ íƒ)</div>
        <div class="course-list">
          <div class="course-item course-korean">ë¬¸í•™ê³¼ ì˜ìƒ_ì§„(4)</div>
          <div class="course-item course-math">ë¯¸ì ë¶„2_ì§„(4)</div>
          <div class="course-item course-english">ì˜ì–´ë…í•´ì™€ ì‘ë¬¸_ì§„(4)</div>
          <div class="course-item course-society">ì‚¬íšŒë¬¸ì œíƒêµ¬_ìœµ(4)</div>
          <div class="course-item course-society">í•œêµ­ì§€ë¦¬íƒêµ¬_ì§„(4)</div>
          <div class="course-item course-society">ìœ¤ë¦¬ì™€ ì‚¬ìƒ_ì§„(4)</div>
          <div class="course-item course-society">ì •ì¹˜_ì§„(4)</div>
          <div class="course-item course-science">ì—­í•™ê³¼ ì—ë„ˆì§€_ì§„(4)</div>
          <div class="course-item course-science">ë¬¼ì§ˆê³¼ ì—ë„ˆì§€_ì§„(4)</div>
          <div class="course-item course-science">í™”í•™ë°˜ì‘ì˜ ì„¸ê³„_ì§„(4)</div>
          <div class="course-item course-science">ì„¸í¬ì™€ ë¬¼ì§ˆëŒ€ì‚¬_ì§„(4)</div>
          <div class="course-item course-science">ì§€êµ¬ì‹œìŠ¤í…œê³¼í•™_ì§„(4)</div>
          <div class="course-item course-science">í–‰ì„±ìš°ì£¼ê³¼í•™_ì§„(4)</div>
          <div class="course-item course-physical">ì‹¬í™”ì²´ìœ¡ì „ê³µì‹¤ê¸°_ì§„(4)</div>
          <div class="course-item course-info">ì¸ê³µì§€ëŠ¥ ê¸°ì´ˆ_ì •(4)</div>
          <div class="course-item course-language">ì‹¬í™” ì¼ë³¸ì–´_ì§„(4)</div>
        </div>
      </div>
      <div class="course-area">
        <div class="area-title">ì„ íƒê³¼ëª©2 (1ê°œ ì„ íƒ)</div>
        <div class="course-list">
          <div class="course-item course-liberal">êµìœ¡ì˜ ì´í•´_ì§„(2)</div>
          <div class="course-item course-liberal">ì¸ê°„ê³¼ ì² í•™_ì§„(2)</div>
          <div class="course-item course-liberal">ì¸ê°„ê³¼ ê²½ì œí™œë™_ìœµ(2)</div>
          <div class="course-item course-liberal">ë…¼ìˆ _ìœµ(2)</div>
        </div>
      </div>
      <div class="basket" id="basket-3-1">
        <div class="basket-title">ë‚´ ì„ íƒê³¼ëª©</div>
      </div>
  </div>
  <div class="semester" id="semester-3-2">
      <h2>3í•™ë…„ 2í•™ê¸°</h2>
      <div class="course-area">
        <div class="area-title">í•„ìˆ˜ ê³¼ëª©</div>
        <div class="course-list">
          <div class="course-item fixed course-physical">ìŠ¤í¬ì¸ ë¬¸í™”_ìœµ(2)</div>
        </div>
      </div>
      <div class="course-area">
        <div class="area-title">ì„ íƒê³¼ëª©1 (4í•™ì  5ê°œ ë˜ëŠ” 4í•™ì  4ê°œ + 2í•™ì  2ê°œ)</div>
        <div class="course-list">
          <div class="course-item course-korean">ì–¸ì–´ìƒí™œíƒêµ¬_ìœµ(4)</div>
          <div class="course-item course-math">ìˆ˜í•™ê³¼ì œíƒêµ¬_ìœµ(4)</div>
          <div class="course-item course-english">ì‹¬í™”ì˜ì–´_ì§„(4)</div>
          <div class="course-item course-english">ì‹¬í™”ì˜ì–´ë…í•´ì™€ ì‘ë¬¸_ì§„(4)</div>
          <div class="course-item course-society">êµ­ì œê´€ê³„ì˜ ì´í•´_ì§„(4)</div>
          <div class="course-item course-society">ë„ì‹œì˜ ë¯¸ë˜ íƒêµ¬_ì§„(4)</div>
          <div class="course-item course-society">ê¸ˆìœµê³¼ ê²½ì œ ìƒí™œ_ìœµ(4)</div>
          <div class="course-item course-science">ê¸°í›„ë³€í™”ì™€ í™˜ê²½ìƒíƒœ_ìœµ(4)</div>
          <div class="course-item course-science">ìœµí•©ê³¼í•™íƒêµ¬_ìœµ(4)</div>
          <div class="course-item course-language">ì¼ë³¸ë¬¸í™”_ìœµ(4)</div>
          <div class="course-item course-liberal">êµìœ¡ì˜ ì´í•´_ì§„(2)</div>
          <div class="course-item course-liberal">ì¸ê°„ê³¼ ì² í•™_ì§„(2)</div>
          <div class="course-item course-liberal">ì¸ê°„ê³¼ ê²½ì œí™œë™_ìœµ(2)</div>
          <div class="course-item course-liberal">ë…¼ìˆ _ìœµ(2)</div>
        </div>
      </div>
      <div class="course-area">
        <div class="area-title">ì„ íƒê³¼ëª©2 (1ê°œ ì„ íƒ)</div>
        <div class="course-list">
          <div class="course-item course-art">ìŒì•…ê°ìƒê³¼ ë¹„í‰_ì§„(4)</div>
          <div class="course-item course-art">ë¯¸ìˆ ê°ìƒê³¼ ë¹„í‰_ì§„(4)</div>
        </div>
      </div>
            <div class="basket" id="basket-3-2">
        <div class="basket-title">ë‚´ ì„ íƒê³¼ëª©</div>
      </div>
  </div>
</div>
<div id="summary-totals" class="total-summary-box">
  <h3>ğŸ§® ì˜ì—­ë³„ ì´í•© ê³„ì‚°ê¸°</h3>
  <p id="summary-core">êµ­ì–´/ìˆ˜í•™/ì˜ì–´ ì˜ì—­ ì´í•©: <strong>0</strong>ì </p>
  <p id="summary-others">ì œ2ì™¸êµ­ì–´/ì •ë³´/êµì–‘ ì˜ì—­ ì´í•©: <strong>0</strong>ì </p>
</div>
<script>
  const domainOrder = [
    'course-korean',
    'course-math',
    'course-english',
    'course-society',
    'course-science',
    'course-physical',
    'course-art',
    'course-info',
    'course-language',
    'course-liberal'
  ];

  function sortByDomain(courseItems) {
    return Array.from(courseItems).sort((a, b) => {
      const getClassIndex = el => domainOrder.findIndex(cls => el.classList.contains(cls));
      return getClassIndex(a) - getClassIndex(b);
    });
  }
</script>
<script>
// ğŸŸ© ìˆ˜ê°•ì‹ ì²­ ë¡œì§
const semesterConfigs = {
  'semester-2-1': 30,
  'semester-2-2': 30,
  'semester-3-1': 28,
  'semester-3-2': 26
};

const courseLimits = {
  'ì„ íƒê³¼ëª©1': 3,
  'ì„ íƒê³¼ëª©2': 1,
  'semester-2-1-ì„ íƒê³¼ëª©3': 1,
  'semester-3-1-ì„ íƒê³¼ëª©1': 4,
  };

function attachClickHandlers() {
  document.querySelectorAll('.course-item').forEach(item => {
    if (!item.classList.contains('fixed')) {
      item.onclick = () => handleCourseClick(item);
    }
  });
}

function handleCourseClick(item) {
  const courseText = item.textContent;
  const semesterEl = item.closest('.semester');
  const semesterId = semesterEl.id;
  const basket = semesterEl.querySelector('.basket');
  const credit = parseInt(courseText.match(/\((\d+)\)/)[1]);

  const alreadySelected = Array.from(basket.querySelectorAll('.course-item')).some(el => el.textContent === courseText);
  if (alreadySelected) {
    alert('í•´ë‹¹ ê³¼ëª©ì„ ì¤‘ë³µ ì‹ ì²­í•˜ì˜€ìŠµë‹ˆë‹¤.');
    return;
  }

  const isGlobalDuplicate = Array.from(document.querySelectorAll('.basket .course-item'))
    .some(el => el.textContent === courseText);
  if (isGlobalDuplicate) {
    alert('ë‹¤ë¥¸ í•™ê¸°ì—ì„œ ì´ë¯¸ ì‹ ì²­í•œ ê³¼ëª©ì…ë‹ˆë‹¤. ì¤‘ë³µ ì‹ ì²­í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }


  const courseArea = item.closest('.course-area');
  const areaTitleText = courseArea?.querySelector('.area-title')?.textContent.trim();
  const areaTitle = areaTitleText?.split(' ')[0];
  const dynamicKey = `${semesterId}-${areaTitle}`;
  const staticKey = areaTitle;
  let limit = courseLimits[dynamicKey] || courseLimits[staticKey];

// ğŸ‘‰ 3í•™ë…„ 2í•™ê¸° ì„ íƒê³¼ëª©1ì€ ê°œìˆ˜ ì œí•œ ì˜ˆì™¸ ì²˜ë¦¬
if (semesterId === 'semester-3-2' && areaTitle === 'ì„ íƒê³¼ëª©1') {
  limit = null;
}

if (limit) {
  const selectedCount = Array.from(basket.querySelectorAll('.course-item')).filter(el => {
    const elArea = el.getAttribute('data-area');
    return elArea === dynamicKey || elArea === staticKey;
  }).length;

  if (selectedCount >= limit) {
    alert(`${areaTitle}ì—ì„œëŠ” ìµœëŒ€ ${limit}ê°œ ê³¼ëª©ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
    return;
  }
}


  const creditUsed = Array.from(basket.querySelectorAll('.course-item'))
    .map(el => parseInt(el.textContent.match(/\((\d+)\)/)[1]))
    .reduce((acc, val) => acc + val, 0);

  const maxCredit = semesterConfigs[semesterId];
  if (creditUsed + credit > maxCredit) {
    alert('ì‹ ì²­ ê°€ëŠ¥í•œ í•™ì ì„ ì´ˆê³¼í•˜ì˜€ìŠµë‹ˆë‹¤.');
    return;
  }

  if (semesterId === 'semester-2-2') {
    const currentCredits = Array.from(basket.querySelectorAll('.course-item'))
      .map(el => parseInt(el.textContent.match(/\((\d+)\)/)[1]));
    const newCredits = [...currentCredits, credit];
    const totalCredits = newCredits.reduce((a, b) => a + b, 0);
    const electiveCredits = totalCredits - 14;
    const num4 = newCredits.filter(c => c === 4).length;
    const num2 = newCredits.filter(c => c === 2).length;

    if (electiveCredits > 16 ||
        (num2 === 1 && num4 > 3) ||
        (num2 === 2 && num4 > 3) ||
        (num2 > 2) ||
        (num4 > 4) ||
        (electiveCredits === 20 && !(num4 === 5 && num2 === 0) && !(num4 === 4 && num2 === 2))) {
      alert('2í•™ë…„ 2í•™ê¸°ëŠ” 4í•™ì  4ê³¼ëª© ë˜ëŠ” 4í•™ì  3ê³¼ëª© + 2í•™ì  2ê³¼ëª©ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
      return;
    }
  }
if (semesterId === 'semester-3-2' && areaTitle === 'ì„ íƒê³¼ëª©1') {
  const basketItems = document.querySelectorAll('#basket-3-2 .course-item');
  const selectedItems1 = Array.from(basketItems).filter(
    el => el.getAttribute('data-area') === 'semester-3-2-ì„ íƒê³¼ëª©1'
  );

  const credits1 = selectedItems1.map(el =>
    parseInt(el.textContent.match(/\((\d+)\)/)[1])
  );
  const total1 = credits1.reduce((a, b) => a + b, 0);
  const num4 = credits1.filter(c => c === 4).length;
  const num2 = credits1.filter(c => c === 2).length;

  // ì´ í•™ì  ì´ˆê³¼ ì‹œ ì°¨ë‹¨
  if (total1 > 20) {
    alert('3í•™ë…„ 2í•™ê¸° ì„ íƒê³¼ëª©1ì€ ìµœëŒ€ 20í•™ì ê¹Œì§€ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
    return;
  }

  // ì¡°í•©ì´ ì¡°ê±´ì— ì•ˆ ë§ì„ ê²½ìš° ì°¨ë‹¨
  if (total1 === 20) {
    const valid =
      (num4 === 5 && num2 === 0) ||
      (num4 === 4 && num2 === 2);

    if (!valid) {
      alert('ì„ íƒê³¼ëª©1ì€ 4í•™ì  5ê³¼ëª© ë˜ëŠ” 4í•™ì  4ê³¼ëª© + 2í•™ì  2ê³¼ëª©ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
      return;
    }
  }
}



  const cloned = item.cloneNode(true);
  cloned.setAttribute('data-area', dynamicKey);

  // âœ… ì‚­ì œ ì´ë²¤íŠ¸ ì¶”ê°€
  cloned.onclick = () => {
    cloned.remove();
    checkCredit(semesterId);
    updateTotalAreaSummary();
    updateSaveButtonVisibility(); // âœ… ê³¼ëª© ì‚­ì œ ì‹œì—ë„ ë²„íŠ¼ ë‹¤ì‹œ íŒë‹¨
  };

  basket.appendChild(cloned);

  checkCredit(semesterId);
  updateTotalAreaSummary();
  updateSaveButtonVisibility(); // âœ… ê³¼ëª© ì¶”ê°€ ì‹œì—ë„ ë²„íŠ¼ íŒë‹¨

console.log('â¡ dynamicKey:', dynamicKey);
console.log('â¡ cloned.getAttribute(data-area):', cloned.getAttribute('data-area'));

}

function checkCredit(semesterId) {
  const semesterEl = document.getElementById(semesterId);
  const basket = semesterEl.querySelector('.basket');
  const maxCredit = semesterConfigs[semesterId];

  const selectedCredits = Array.from(basket.querySelectorAll('.course-item'))
    .map(el => parseInt(el.textContent.match(/\((\d+)\)/)[1]));

  const fixedCredits = Array.from(semesterEl.querySelectorAll('.course-item.fixed'))
    .map(el => parseInt(el.textContent.match(/\((\d+)\)/)[1]));

  const total = [...selectedCredits, ...fixedCredits].reduce((acc, val) => acc + val, 0);

  const summaryId = `summary-${semesterId}`;
  let summary = document.getElementById(summaryId);
  if (!summary) {
    summary = document.createElement('div');
    summary.id = summaryId;
    summary.style.marginTop = '8px';
    summary.style.fontSize = '13px';
    summary.style.fontWeight = 'bold';
    basket.parentNode.appendChild(summary);
  }
  summary.textContent = `í˜„ì¬ í•™ì  ì´í•©: ${total} / ${maxCredit}`;

  if (total === maxCredit) {
    basket.classList.add('highlight-valid');
  } else {
    basket.classList.remove('highlight-valid');
  }

  updateSaveButtonVisibility(); // âœ… ì €ì¥ ë²„íŠ¼ ì¡°ê±´ ì¬ê²€ì‚¬
}

function updateSaveButtonVisibility() {
  const allValid = Object.keys(semesterConfigs).every(id => {
    const el = document.getElementById(id)?.querySelector('.basket');
    return el?.classList.contains('highlight-valid');
  });

  const saveBtn = document.getElementById('save-btn');
  if (allValid) {
    saveBtn.style.backgroundColor = '#4CAF50';
    saveBtn.style.color = 'white';
    saveBtn.style.cursor = 'pointer';
    saveBtn.dataset.active = 'true'; // âœ… í™œì„± ìƒíƒœ í‘œì‹œ
  } else {
    saveBtn.style.backgroundColor = '#ccc';
    saveBtn.style.color = '#666';
    saveBtn.style.cursor = 'default';
    saveBtn.dataset.active = 'false';
  }
}


function updateTotalAreaSummary() {
  const allCourses = document.querySelectorAll('.basket .course-item, .course-item.fixed');
  let coreSum = 0;
  let othersSum = 0;

  allCourses.forEach(el => {
    const credit = parseInt(el.textContent.match(/\((\d+)\)/)?.[1] || '0');
    if (
      el.classList.contains('course-korean') ||
      el.classList.contains('course-math') ||
      el.classList.contains('course-english')
    ) {
      coreSum += credit;
    }
    if (
      el.classList.contains('course-language') ||
      el.classList.contains('course-info') ||
      el.classList.contains('course-liberal')
    ) {
      othersSum += credit;
    }
  });

  document.getElementById('summary-core').innerHTML = `êµ­ì–´/ìˆ˜í•™/ì˜ì–´ ì˜ì—­ ì´í•©: <strong>${coreSum}</strong>ì `;
  document.getElementById('summary-others').innerHTML = `ì œ2ì™¸êµ­ì–´/ì •ë³´/êµì–‘ ì˜ì—­ ì´í•©: <strong>${othersSum}</strong>ì `;

  // âœ… ì¡°ê±´ ë§Œì¡± ì‹œ ì—°ë‘ìƒ‰ ìœ ì§€, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ìƒ‰ ì œê±°
  const summaryBox = document.getElementById('summary-totals');
  if (coreSum <= 57 && othersSum >= 12) {
    summaryBox.style.backgroundColor = '#e8f5e9'; // ì—°ë‘ ë°°ê²½
    summaryBox.style.border = '2px solid #4CAF50'; // ë…¹ìƒ‰ í…Œë‘ë¦¬
    summaryBox.style.color = '#2e7d32'; // ë…¹ìƒ‰ ê¸€ì
  } else {
    summaryBox.style.backgroundColor = 'transparent'; // ê¸°ë³¸ ë°°ê²½
    summaryBox.style.border = 'none'; // í…Œë‘ë¦¬ ì œê±°
    summaryBox.style.color = '#000'; // ì¼ë°˜ ê¸€ììƒ‰
  }
}



window.onload = () => {
  attachClickHandlers();

  document.querySelectorAll('.semester').forEach(sem => {
    const sid = sem.id;
    checkCredit(sid);
  });

  updateTotalAreaSummary(); // <- ì—¬ê¸°ì— ê³ ì • ê³¼ëª©ë„ í¬í•¨ë˜ë„ë¡ ìˆ˜ì •
  updateSaveButtonVisibility();
};

</script>
<!-- ì €ì¥ ë²„íŠ¼ ì¶”ê°€ -->
<button id="save-btn" style="position:fixed; bottom:60px; right:20px; padding:10px 20px; font-weight:bold; background:#ccc; color:#666; border:none; border-radius:8px; cursor:default;">ì €ì¥</button>



<script>
document.getElementById('save-btn').onclick = () => {
  const isActive = document.getElementById('save-btn').dataset.active === 'true';
  if (!isActive) {
    alert('ì¡°ê±´ì´ ì¶©ì¡±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
    return;
  }
  // ì „ì²´ ì €ì¥ ë¡œì§ ë‚´ìš©ì´ ì—¬ê¸°ì— ìˆì–´ì•¼ í•´!

  const countedTexts = new Set();

  const totalCoreCredits = Array.from(document.querySelectorAll('.basket .course-item, .course-item.fixed')).reduce((acc, el) => {
    if (
      (el.classList.contains('course-korean') ||
      el.classList.contains('course-math') ||
      el.classList.contains('course-english'))
    ) {
      const text = el.textContent;
      if (!countedTexts.has(text)) {
        countedTexts.add(text);
        const credit = parseInt(text.match(/\((\d+)\)/)?.[1] || '0');
        return acc + credit;
      }
    }
    return acc;
  }, 0);

  if (totalCoreCredits > 57) {
  alert('êµ­ì–´, ìˆ˜í•™, ì˜ì–´ ì˜ì—­ì˜ ì‹ ì²­ ì´í•©ì€ 57ì ì„ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');

  // íŒŒë€ í…Œë‘ë¦¬ ì¶”ê°€
  document.querySelectorAll('.course-korean, .course-math, .course-english').forEach(el => {
    el.style.outline = '2px solid blue';
    el.style.outlineOffset = '-2px';
  });

  return;
} else {
  // íŒŒë€ í…Œë‘ë¦¬ ì œê±°
  document.querySelectorAll('.course-korean, .course-math, .course-english').forEach(el => {
    el.style.outline = '';
    el.style.outlineOffset = '';
  });
}


  const etcCredits = Array.from(document.querySelectorAll('.basket .course-item')).reduce((acc, el) => {
    if (
      el.classList.contains('course-language') ||
      el.classList.contains('course-info') ||
      el.classList.contains('course-liberal')
    ) {
      const credit = parseInt(el.textContent.match(/\((\d+)\)/)?.[1] || '0');
      return acc + credit;
    }
    return acc;
  }, 0);

if (etcCredits < 12) {
  alert('ì œ2ì™¸êµ­ì–´, ì •ë³´, êµì–‘ ì˜ì—­ì˜ ì‹ ì²­ ì´í•©ì€ 12ì  ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');

  // ë¹¨ê°„ í…Œë‘ë¦¬ í‘œì‹œ
  document.querySelectorAll('.course-language, .course-info, .course-liberal').forEach(el => {
    el.classList.add('red-outline');
  });

  return;
} else {
  // ì¡°ê±´ ë§Œì¡± ì‹œ í…Œë‘ë¦¬ ì œê±°
  document.querySelectorAll('.course-language, .course-info, .course-liberal').forEach(el => {
    el.classList.remove('red-outline');
  });
}


  const studentId = document.getElementById('studentId').value.trim();
  const studentName = document.getElementById('studentName').value.trim();
 const studentMajor = document.getElementById('studentMajor').value.trim();


  if (!studentId || !studentName) {
    alert('í•™ë²ˆê³¼ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”');
    return;
  }

  const capture = document.createElement('div');
  capture.style.width = '1123px';
  capture.style.minHeight = '794px';
  capture.style.display = 'grid';
  capture.style.gridTemplateColumns = 'repeat(4, 1fr)';
  capture.style.gap = '12px';
  capture.style.padding = '20px 24px 16px 24px';
  capture.style.boxSizing = 'border-box';
  capture.style.background = 'white';
  capture.style.fontFamily = 'Arial';
  capture.style.border = '1px solid #ccc';
  capture.style.position = 'fixed';
  capture.style.top = '-9999px';
  capture.style.alignContent = 'start';
  capture.style.justifyItems = 'start';

  const titleSection = document.createElement('div');
  titleSection.style.gridColumn = '1 / -1';
  titleSection.style.paddingBottom = '6px';
  titleSection.style.marginBottom = '6px';
  titleSection.style.borderBottom = '1px solid #bbb';

  const header = document.createElement('h2');
  header.textContent = `ì˜¤ë¥˜ê³ ë“±í•™êµ ê³¼ëª© ì„ íƒ ìˆ˜ê°•ì‹ ì²­ ê²°ê³¼`;
  header.style.fontSize = '18px';
  header.style.margin = '0 0 4px';

  const info = document.createElement('p');
  info.textContent = `í•™ë²ˆ: ${studentId} / ì´ë¦„: ${studentName} / í¬ë§í•™ê³¼(ê³„ì—´): ${studentMajor}`;
  info.style.margin = '0';
  info.style.fontSize = '13px';

  titleSection.appendChild(header);
  titleSection.appendChild(info);
  capture.appendChild(titleSection);

  Object.keys(semesterConfigs).forEach(id => {
    const sem = document.getElementById(id);
    const title = sem.querySelector('h2').textContent;
    const fixedCourses = Array.from(sem.querySelectorAll('.course-item.fixed'));
    const selectedCourses = Array.from(sem.querySelectorAll(`#${id} .basket .course-item`));

    const box = document.createElement('div');
    box.style.width = '100%';
    box.style.border = '1px solid #ddd';
    box.style.borderRadius = '10px';
    box.style.padding = '6px 8px';
    box.style.background = '#ffffff';
    box.style.boxShadow = '0 1px 3px rgba(0,0,0,0.05)';
    box.style.display = 'flex';
    box.style.flexDirection = 'column';
    box.style.gap = '2px';
    box.style.minHeight = '140px';
    box.style.boxSizing = 'border-box';

    const sub = document.createElement('h3');
    sub.textContent = title;
    sub.style.borderBottom = '1px solid #aaa';
    sub.style.paddingBottom = '4px';
    sub.style.marginBottom = '6px';
    sub.style.fontSize = '14px';
    sub.style.marginTop = '0';
    box.appendChild(sub);

    const createCourseEntry = (el) => {
      const p = document.createElement('p');
      const bgColor = window.getComputedStyle(el).backgroundColor;

      p.textContent = `- ${el.textContent}`;
      p.style.display = 'inline-block';
      p.style.margin = '1px';
      p.style.padding = '2px 5px';
      p.style.borderRadius = '4px';
      p.style.fontSize = '11px';
      p.style.whiteSpace = 'nowrap';
      p.style.backgroundColor = bgColor;

      return p;
    };

   // ğŸ“˜ í•„ìˆ˜ ê³¼ëª© ë¼ë²¨
if (fixedCourses.length > 0) {
  const fixedLabel = document.createElement('p');
  fixedLabel.textContent = 'ğŸ“˜ í•„ìˆ˜ ê³¼ëª©';
  fixedLabel.style.fontWeight = 'bold';
  fixedLabel.style.margin = '4px 0 2px';
  fixedLabel.style.fontSize = '12px';
  box.appendChild(fixedLabel);
  fixedCourses.forEach(el => box.appendChild(createCourseEntry(el)));
}

// ğŸ“— ì„ íƒ ê³¼ëª© ë¼ë²¨
if (selectedCourses.length > 0) {
  const selectLabel = document.createElement('p');
  selectLabel.textContent = 'ğŸ“— ì„ íƒ ê³¼ëª©';
  selectLabel.style.fontWeight = 'bold';
  selectLabel.style.margin = '6px 0 2px';
  selectLabel.style.fontSize = '12px';
  box.appendChild(selectLabel);
  sortByDomain(selectedCourses).forEach(el => box.appendChild(createCourseEntry(el)));
}


// âœ… ë¯¸ì„ íƒ ê³¼ëª©
const allSelectable = Array.from(sem.querySelectorAll('.course-area:not(:first-child) .course-item'))
  .filter(el => !el.classList.contains('fixed'));
const unselectedCourses = allSelectable.filter(el =>
  !selectedCourses.some(sel => sel.textContent === el.textContent)
);

if (unselectedCourses.length > 0) {
  const missedLabel = document.createElement('p');
  missedLabel.textContent = 'ğŸ“• ë¯¸ì„ íƒ ê³¼ëª©';
  missedLabel.style.fontWeight = 'bold';
  missedLabel.style.margin = '18px 0 2px';
  missedLabel.style.fontSize = '12px';
  box.appendChild(missedLabel);

  sortByDomain(unselectedCourses).forEach(el => box.appendChild(createCourseEntry(el)));
}


    capture.appendChild(box);
  });

// âœ… ê²°ê³¼í™”ë©´ ìƒë‹¨ ì˜¤ë¥¸ìª½ì— ë²”ë¡€ ì¶”ê°€
const legendBox = document.createElement('div');
legendBox.style.position = 'absolute';
legendBox.style.top = '20px';
legendBox.style.right = '20px';
legendBox.style.display = 'flex';
legendBox.style.flexWrap = 'wrap';
legendBox.style.gap = '6px';
legendBox.style.background = '#f9f9f9';
legendBox.style.padding = '8px 12px';
legendBox.style.border = '1px solid #ccc';
legendBox.style.borderRadius = '8px';
legendBox.style.fontSize = '11px';
legendBox.style.boxShadow = '0 2px 5px rgba(0,0,0,0.1)';

// ë²”ë¡€ í•­ëª©ë“¤ ì •ì˜
const legendItems = [
  { name: 'êµ­ì–´', color: '#fff9c4' },
  { name: 'ìˆ˜í•™', color: '#bbdefb' },
  { name: 'ì˜ì–´', color: '#ffcdd2' },
  { name: 'ì‚¬íšŒ', color: '#ffe0b2' },
  { name: 'ê³¼í•™', color: '#c8e6c9' },
  { name: 'ì²´ìœ¡', color: '#CCD5FF' },
  { name: 'ì˜ˆìˆ ', color: '#f8bbd0' },
  { name: 'ì •ë³´', color: '#b2dfdb' },
  { name: 'ì œ2ì™¸êµ­ì–´', color: '#e1bee7' },
  { name: 'êµì–‘', color: '#e4dcd9' }
];

legendItems.forEach(item => {
  const div = document.createElement('div');
  div.textContent = item.name;
  div.style.backgroundColor = item.color;
  div.style.padding = '3px 8px';
  div.style.borderRadius = '6px';
  div.style.whiteSpace = 'nowrap';
  legendBox.appendChild(div);
});

capture.appendChild(legendBox);


  document.body.appendChild(capture);

  setTimeout(() => {
    html2canvas(capture).then(canvas => {
      const image = canvas.toDataURL('image/png');

      const link = document.createElement('a');
      link.href = image;
      link.download = `ìˆ˜ê°•ì‹ ì²­ê²°ê³¼_${studentId}_${studentName || 'unknown'}.png`;
      document.body.appendChild(link);

      link.click();
      alert('ìˆ˜ê°•ì‹ ì²­ ê²°ê³¼ê°€ ì´ë¯¸ì§€ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');

      document.body.removeChild(link);
      document.body.removeChild(capture);
    }).catch(err => {
      alert('ì´ë¯¸ì§€ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      console.error(err);
      document.body.removeChild(capture);
    });
  }, 300);
};
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</body>
</html>
